import{r as a,j as e}from"./react-BHsabnSR.js";/* empty css            */import{c as Fe}from"./react-dom-D4UAywob.js";import{F as $e,a as oe,b as Ee,c as Re,d as _e,e as ge,f as Ke,g as Me,h as he,i as fe,j as be,k as je,l as ke,L as le,m as ze,n as Ue,B as He,A as We,o as ie,p as Ge,q as qe,M as Oe,H as Je}from"./react-icons-D2vXvtR5.js";import"./firebase-CdKMumJT.js";import{i as Ve,g as Ye,G as Xe,a as Qe,b as Ze,o as et,c as tt,d as at,s as st,e as nt,f as rt,h as it}from"./@firebase-CEeiVtla.js";import{S as v}from"./sweetalert2-NNS-RXd7.js";import{a as $}from"./axios-R-lXtGyY.js";import{m as X,A as ot}from"./framer-motion-CzYJo8Ah.js";import{N as lt,u as ye,a as we,O as ct,L as dt,B as mt,R as ut,b as Y}from"./react-router-CcgYs15i.js";import{X as xt}from"./lucide-react-P4zxE1Tt.js";import{X as gt}from"./react-data-table-component-A8du1t1w.js";import{B as pt,D as ht}from"./react-chartjs-2-Cyjvmm_D.js";import{C as ft,L as bt,A as jt,p as kt,g as yt,h as wt,P as vt,B as Nt}from"./chart.js-fU3pd5hi.js";import{p as Ct}from"./chartjs-plugin-datalabels-D-zOrnaG.js";import{p as St}from"./dompurify-DxJI3Wx7.js";import"./cookie-CqkleIqs.js";import"./scheduler-Bb8JjhAW.js";import"./idb-Bn1DMRyg.js";import"./motion-dom-DJTSrtOH.js";import"./motion-utils-CjIqCkNq.js";import"./styled-components-Dw0pCDld.js";import"./@emotion-sScrWPmR.js";import"./stylis-DinRj2j6.js";import"./@kurkle-D8fDXNIl.js";const Tt={apiKey:"AIzaSyBVvQbF0e2VZgLMwlWwyOYYicWsyd527qw",authDomain:"appcashflow-24596.firebaseapp.com",projectId:"appcashflow-24596",storageBucket:"appcashflow-24596.firebasestorage.app",messagingSenderId:"1063434393739",appId:"1:1063434393739:web:79aadcabdb225692179c8e",measurementId:"G-XFCWT8FG5V"},ce=Ve(Tt),de=Ye(ce),Pt=new Xe,It=Qe(ce),ve=Ze(ce),E="https://moneymind.cloud/api",Ne="https://moneymind.cloud/BeOCR/ocr-image",Bt=async t=>{try{if(await Notification.requestPermission()!=="granted"){v.fire({title:"Notifikasi tidak di izinkan",icon:"info",showConfirmButton:!1,timer:12500});return}const u=await tt(ve,{vapidKey:void 0});if(!u){v.fire({title:"gagal ambil token",icon:"info",showConfirmButton:!1,timer:12500});return}const l=await t.getIdToken(),x=await $.post(`${E}/token-fcm`,{user_id:t.uid,token:u},{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(x.status!==200)throw new Error(`Gagal simpan token: ${x.status}`)}catch(n){console.log(n)}},Lt=()=>new Promise((t,n)=>{try{et(ve,u=>{t(u)})}catch(u){n(u)}});"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js");const Ce=a.createContext(),At=({children:t})=>{const[n,u]=a.useState(null),[l,x]=a.useState(!0);return a.useEffect(()=>{const c=at(de,g=>{u(g),x(!1)});return()=>c()},[]),e.jsx(Ce.Provider,{value:{user:n,loading:l},children:t})},M=()=>a.useContext(Ce),Dt=({children:t})=>{const{user:n,loading:u}=M();if(u){const l="memuat...";return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-50",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("div",{className:"mt-5 flex space-x-1 text-3xl font-semibold capitalize",children:l.split("").map((x,c)=>e.jsx(X.span,{initial:{y:0},animate:{y:[-5,0,-5]},transition:{duration:.6,repeat:1/0,repeatDelay:l.length*.08,delay:c*.08},className:"inline-block text-sky-600",children:x},c))})]})}return n?t:e.jsx(lt,{to:"/",replace:!0})},Se=a.createContext(),Ft=({children:t})=>{const{user:n}=M(),[u,l]=a.useState([]),[x,c]=a.useState(0),[g,d]=a.useState(0),[h,p]=a.useState(0),[i,m]=a.useState(!0),f=async()=>{if(!n)return;const k=await n.getIdToken();try{const j=(await $.get(`${E}/list-transaksi`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`}})).data.data,S=j.filter(s=>s.type==="pemasukan").reduce((s,o)=>s+parseInt(o.amount),0),L=j.filter(s=>s.type==="pengeluaran").reduce((s,o)=>s+parseInt(o.amount),0);l(j),d(S),p(L),c(S+L)}catch(T){console.log(T)}finally{m(!1)}};return a.useEffect(()=>{f()},[n]),e.jsx(Se.Provider,{value:{listTransaksi:u,totalTransaksi:x,totalPemasukan:g,totalPengeluaran:h,loading:i,getTransaksi:f},children:t})},$t=()=>a.useContext(Se),ae=a.createContext(),Et=({children:t})=>{const{user:n}=M(),[u,l]=a.useState(""),[x,c]=a.useState([]),[g,d]=a.useState(null),[h,p]=a.useState(!1),i=async()=>{const f=await n.getIdToken();try{const k=await $.get(`${E}/list-kategori`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`}});c(k.data.data)}catch{}},m=async()=>{const f=await n.getIdToken();if(!u||!g){v.fire({icon:"info",text:"kategori & icon harap di isi",showConfirmButton:!1,timer:1500});return}const k={name:u,icon:g};try{(await $.post(`${E}/tambah-kategori`,k,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`}})).data.success&&(v.fire({icon:"success",title:"Kategori berhasil ditambahkan",showConfirmButton:!1,timer:1500}),p(!1),l(""),d(null),i())}catch(T){T.response&&v.fire({icon:"error",text:T.response.data.message,showConfirmButton:!1,timer:1500})}};return a.useEffect(()=>{n&&i()},[n]),e.jsx(ae.Provider,{value:{kategoriBaru:u,setKategoriBaru:l,kategoriAll:x,addKategori:m,selectedIcon:g,setSelectedIcon:d,showPopup:h,setShowPopup:p},children:t})},Rt=({transaksi:t,onClose:n,onSave:u,onDeleted:l,onEditmode:x})=>{var L;const{user:c}=M(),{kategoriAll:g}=a.useContext(ae),[d,h]=a.useState(t.note),[p,i]=a.useState(t.amount),[m,f]=a.useState(t.type),[k,T]=a.useState(((L=t.list_kategori)==null?void 0:L.kategori_id)??"");a.useEffect(()=>{var s;(s=t==null?void 0:t.list_kategori)!=null&&s.kategori_id&&T(t.list_kategori.kategori_id)},[t]);const j=async()=>{var o,y;if(!k){v.fire({icon:"warning",text:"Kategori belum dipilih!",showConfirmButton:!1,timer:1500});return}const s=await c.getIdToken();try{const N={note:d,amount:parseInt(p),type:m,kategori:parseInt(k)};await $.post(`${E}/transaksi-update/${t.id}`,N,{headers:{Authorization:`Bearer ${s}`}}),v.fire({icon:"success",text:"Transaksi berhasil diperbarui!",showConfirmButton:!1,timer:1500}),u(),x(!1),n()}catch(N){v.fire({icon:"error",text:((y=(o=N.response)==null?void 0:o.data)==null?void 0:y.message)||"Terjadi kesalahan saat update transaksi.",showConfirmButton:!1,timer:1500})}},S=async()=>{const s=await c.getIdToken();v.fire({title:"Apakah anda ingin menghapus list transaksi anda?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya"}).then(async o=>{if(o.isConfirmed)try{const y=await $.delete(`${E}/remove-transaksi/${t.id}`,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});v.fire({icon:"success",text:y.data.message,showConfirmButton:!1,timer:1500}),n(),l()}catch{v.fire("Error","Gagal menghapus transaksi","error")}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-11/12 max-w-md",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-t-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Detail Catatan"}),e.jsx("p",{className:"text-sm text-blue-100",children:"Edit Detail Transaksi Anda"})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("label",{className:"block font-medium mb-2",children:"Catatan"}),e.jsx("textarea",{value:d,className:"w-full border border-indigo-600 rounded p-2 mb-2 h-25 resize-none",onChange:s=>h(s.target.value)}),e.jsx("label",{className:"block font-medium mb-2",children:"Jumlah Nominal"}),e.jsx("input",{type:"number",className:"w-full border border-indigo-600 rounded p-2 mb-2",value:p,onChange:s=>i(s.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"Tipe"}),e.jsxs("select",{value:m,onChange:s=>f(s.target.value),className:"w-full border border-indigo-600 rounded mb-2 p-2",children:[e.jsx("option",{value:"pemasukan",children:"Pemasukan"}),e.jsx("option",{value:"pengeluaran",children:"Pengeluaran"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-2",children:"Kategori"}),e.jsxs("select",{value:k,onChange:s=>T(parseInt(s.target.value)),className:"w-full border border-indigo-600 rounded p-2 bg-gray-100 uppercase",children:[e.jsx("option",{value:"",children:"Pilih kategori"}),g.map(s=>e.jsx("option",{value:s.kategori_id,children:s.name.toUpperCase()},s.kategori_id))]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3",children:[e.jsx("button",{className:"text-2xl text-red-600 hover:scale-110",onClick:S,children:e.jsx($e,{})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded-lg",onClick:n,children:"Batal"}),e.jsx("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg",onClick:j,children:"Update"})]})]})]})})},_t=({setResultOcr:t,setTipeMode:n,setPreviewImage:u,setProsesLoading:l})=>{const x=a.useRef(null),[c,g]=a.useState(null),[d,h]=a.useState(!1),[p,i]=a.useState(!1),{user:m}=M();let f;const k=async()=>{try{f=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1}),x.current&&(x.current.srcObject=f,g(f),h(!0))}catch(j){console.log(j),v.fire({icon:"info",showConfirmButton:!1,timer:1500,text:"kamera tidak bisa di akses,harap cek izin nya"})}};a.useEffect(()=>(k(),()=>{f&&f.getTracks().forEach(j=>j.stop())}),[]);const T=async()=>{if(!d||!x.current){v.fire({icon:"info",showConfirmButton:!1,timer:1500,text:"kamera nya belum siap :("});return}i(!0),l(!0);try{const j=x.current;(j.videoWidth===0||j.videoHeight===0)&&await new Promise(y=>{j.onloadedmetadata=()=>y()});const S=document.createElement("canvas");S.width=j.videoWidth,S.height=j.videoHeight,S.getContext("2d").drawImage(j,0,0,S.width,S.height);const L=S.toDataURL("image/jpeg");u(L);const s=await m.getIdToken(),o=await $.post(Ne,{image:L},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});o.data&&t(o.data),c&&c.getTracks().forEach(y=>y.stop()),setTimeout(()=>{n(null)},200)}catch(j){v.fire({icon:"warning",showConfirmButton:!1,text:j.message})}finally{i(!1),l(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center p-2",children:[e.jsx(oe,{className:"size-7 mb-2"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Ambil Foto Struk"}),e.jsx("video",{ref:x,autoPlay:!0,playsInline:!0,muted:!0,className:"rounded-xl shadow-md w-full max-w-md bg-black size-75"}),!d&&e.jsx("p",{className:"text-gray-500 text-xl mt-2 animate-pulse",children:"Aktifkan kamera"}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx("button",{className:`px-4 py-2 rounded-lg text-white transition ${p?"bg-gray-400 cursor-not-allowed":"bg-green-700"}`,onClick:T,children:p?"membaca file":"Ambil Foto"}),e.jsx("button",{className:"bg-red-500 rounded-lg hover:bg-red-600 transition text-white px-4 py-2",onClick:()=>{c&&c.getTracks().forEach(j=>j.stop()),n(null)},children:"Batal"})]}),p&&e.jsx("div",{className:"mt-4 text-indigo-600 text-sm animate-pulse",children:"Harap menunggu sedang membaca file ya..."})]})})},K=t=>t.toLocaleString("id-ID",{style:"currency",currency:"IDR"}),Kt=t=>new Promise((n,u)=>{const l=new FileReader;l.onload=()=>n(l.result),l.onerror=u,l.readAsDataURL(t)}),Mt=()=>{const[t,n]=a.useState(""),[u,l]=a.useState(0),[x,c]=a.useState(!1),[g,d]=a.useState(null),[h,p]=a.useState(!1),[i,m]=a.useState("manual"),[f,k]=a.useState(null),[T,j]=a.useState(!1),[S,L]=a.useState(null),[s,o]=a.useState(""),[y,N]=a.useState(!1),[P,C]=a.useState([]),{totalTransaksi:D,totalPemasukan:W,totalPengeluaran:se,loading:G,getTransaksi:q,listTransaksi:O}=$t(),{user:Q}=M(),{kategoriBaru:ne,setKategoriBaru:me,kategoriAll:ue,addKategori:I,selectedIcon:A,setSelectedIcon:H,showPopup:R,setShowPopup:Z}=a.useContext(ae),[b,z]=a.useState(null),J=[{name:"transportasi",icon:he,color:"text-blue-500"},{name:"makan",icon:fe,color:"text-yellow-500"},{name:"bill",icon:be,color:"text-green-500"},{name:"tabungan",icon:je,color:"text-pink-500"},{name:"donasi",icon:ke,color:"text-purple-500"},{name:"lain-lain",icon:le,color:"text-pink-500"}],ee=(r,w=1200,B=.6)=>new Promise(F=>{const _=new Image;_.src=r,_.onload=()=>{const U=document.createElement("canvas"),V=U.getContext("2d");let Ae=_.width/_.height;U.width=w,U.height=w/Ae,V.drawImage(_,0,0,U.width,U.height);const De=U.toDataURL("image/jpeg",B);F(De)}}),xe=r=>{let w=r.target.value.replace(/\D/g,"");if(!w){n(""),l(0);return}const B=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(w);n(B),l(parseInt(w,10))},Te=async r=>{var B;r.preventDefault();const w=await Q.getIdToken();try{const F=new FormData(r.target),_={jenis_transaksi:F.get("jenis_transaksi"),jumlah:u,deskripsi:F.get("note"),kategori:F.get("kategori")},U=await fetch(`${E}/tambah-transaksi`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(_)});if(!U.ok){v.fire({icon:"error",text:"gagal simpan",showConfirmButton:!1,timer:1500});return}const V=await U.json();V.kode===200?(v.fire({icon:"success",title:"Berhasil",text:"Transaksi berhasil ditambahkan!",showConfirmButton:!1,timer:1500}),l(0),n(""),o(""),q(),j(!0),z(null),k(null),r.target.reset()):V.kode===302&&v.fire({icon:"info",text:V.message,showConfirmButton:!1,timer:1500})}catch(F){console.log((B=F.response)==null?void 0:B.data)}},Pe=r=>{d(r),p(!0)},Ie=async r=>{if(!r){v.fire({icon:"info",timer:1500,showConfirmButton:!1,text:"Upload foto struk dulu"});return}const w=await Q.getIdToken();j(!0),z(null);try{const B=await $.post(Ne,{image:r},{headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}});B.data.status==="berhasil"?(z(B.data),j(!1)):v.fire({icon:"info",text:B.data.message,showConfirmButton:!1,timer:1300})}catch(B){console.log(B),j(!1)}},Be=async r=>{r.preventDefault();const w=r.target.files[0];let B=w.name.substring(w.name.lastIndexOf(".")+1).toLowerCase();if(!["jpg","png","jpeg"].includes(B)){v.fire({icon:"warning",timer:1500,title:"Gagal Upload",text:"Harap upload foto dengan format benar",showConfirmButton:!1});return}const F=await Kt(w),_=await ee(F);k(_),await Ie(_)},Le=()=>{k(null),z(null)},[re,te]=a.useState({deskripsi:(b==null?void 0:b.deskripsi)||"",kategori:(b==null?void 0:b.kategori)||"",jenis:(b==null?void 0:b.jenis)||""});return a.useEffect(()=>{if(b!=null&&b.total){const r=Number(String(b.total).replace(/[^\d]/g,"")),w=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r).replace("Rp","Rp.");n(w),l(r)}te({deskripsi:(b==null?void 0:b.deskripsi)||"",kategori:(b==null?void 0:b.kategori)||"",jenis:(b==null?void 0:b.jenis)||""})},[b]),a.useEffect(()=>{N(!0);const r=setTimeout(()=>{C(O),N(!1)},600);return()=>clearTimeout(r)},[O]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-1 container mx-auto w-full",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-500",children:["Total Transaksi Bulan"," ",new Date().toLocaleString("id-ID",{month:"long",year:"numeric"})]}),e.jsx("h2",{className:"text-xl font-bold",children:G?"Loading...":K(D)})]}),e.jsx(Ee,{className:"text-indigo-600 text-3xl"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-xl flex items-center justify-between w-auto",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total Pemasukan"}),e.jsx("h2",{className:"text-xl font-bold text-green-600",children:G?"Loading...":K(W)})]}),e.jsx(Re,{className:"text-green-500 text-3xl"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total Pengeluaran"}),e.jsx("h2",{className:"text-xl font-bold text-red-600",children:G?"Loading...":K(se)})]}),e.jsx(_e,{className:"text-red-500 text-3xl"})]})]})}),e.jsx("div",{className:"p-3 md:p-6 lg:p-7",children:e.jsx("form",{onSubmit:r=>Te(r),children:e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-3 sm:p-6 mx-auto container",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Tambah Transaksi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>m("manual"),className:`flex flex-col items-center justify-center border-rounded-xl p-2 transition-all cursor-pointer ${i==="manual"?"bg-blue-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(ge,{className:"text-2xl mb-2"}),e.jsx("span",{className:"font-medium",children:"Input Manual"}),e.jsx("p",{className:"text-sm opacity-80",children:"Masukan data transaksi secara manual"})]}),e.jsxs("button",{type:"button",onClick:()=>m("ocr"),className:`flex flex-col items-center justify-center border-rounded-xl p-2 transition-all cursor-pointer ${i==="ocr"?"bg-blue-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(ge,{className:"text-2xl mb-2"}),e.jsx("span",{className:"font-medium",children:"Scan Foto "}),e.jsx("p",{className:"text-sm opacity-80",children:"Scan atau foto struk transaksi"})]})]}),i==="manual"&&e.jsxs("div",{className:"animate-fadeIn mt-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Jenis Transaksi"}),e.jsxs("select",{name:"jenis_transaksi",className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"pemasukan",children:"Pemasukan"}),e.jsx("option",{value:"pengeluaran",children:"Pengeluaran"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Jumlah (Rp)"}),e.jsx("input",{type:"text",inputMode:"numeric",className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",name:"jumlah",onChange:xe,value:t,placeholder:"Masukkan jumlah rupiah",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Deskripsi"}),e.jsx("textarea",{name:"note",className:"w-full focus:outline-none focus:ring-2 focus:ring-indigo-500 border rounded-lg p-3 h-30",placeholder:"Masukkan keterangan, contoh: makan siang",required:!0})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Kategori"}),e.jsxs("select",{name:"kategori",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",children:[e.jsx("option",{value:"",children:"Pilih kategori"}),ue.map(r=>e.jsx("option",{value:r.kategori_id,children:r.name.toUpperCase()},r.kategori_id))]}),e.jsx("button",{className:"text-sm mt-2 text-indigo-600 cursor-pointer",onClick:r=>{r.preventDefault(),Z(!0)},children:"+ Tambah Kategori Baru"})]}),e.jsx("button",{className:"w-full py-3 mt-3 cursor-pointer rounded-lg bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-semibold shadow-md hover:opacity-90 transition",type:"submit",children:"Tambah Transaksi"})]}),i==="ocr"&&e.jsx("div",{className:"border-dashed border-2 rounded-xl p-6  space-y-6 animate-fadeIn mt-3",children:e.jsx("div",{children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-75 m-auto",children:e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative w-75 m-auto",children:f&&S===null&&e.jsxs("div",{className:"relative w-full",children:[e.jsx("img",{src:f,alt:"Preview",className:"rounded-xl shadow-md mb-4 w-full"}),e.jsx("button",{onClick:Le,className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-lg hover:bg-red-600",children:"Remove"})]})})})}),T?e.jsxs("div",{className:"flex flex-col items-center justify-center py-6",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mb-3"}),e.jsx("p",{className:"text-indigo-600 font-semibold animate-pulse",children:"Harap menunggu,sedang membaca file.."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl mb-2 flex items-center",children:["Detail Struk",(b==null?void 0:b.tanggal)&&e.jsx("span",{className:"relative -top-1 ml-1 bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-sm",children:b.tanggal})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Jenis Transaksi"}),e.jsxs("select",{value:re.jenis,onChange:r=>{te(w=>({...w,jenis:r.target.value}))},name:"jenis_transaksi",className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Pilih Jenis Transaksi"}),e.jsx("option",{value:"pemasukan",children:"Pemasukan"}),e.jsx("option",{value:"pengeluaran",children:"Pengeluaran"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Jumlah (Rp)"}),e.jsx("input",{type:"text",inputMode:"numeric",className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",name:"jumlah",onChange:xe,value:t,placeholder:"Masukkan jumlah rupiah",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Deskripsi"}),e.jsx("textarea",{required:!0,name:"note",className:"w-full focus:outline-none focus:ring-2 focus:ring-indigo-500 border rounded-lg p-3 h-30",placeholder:"Masukkan keterangan, contoh: makan siang",value:re.deskripsi,onChange:r=>{te(w=>({...w,deskripsi:r.target.value}))}})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Kategori"}),e.jsx("input",{type:"text",name:"kategori",value:re.kategori,onChange:r=>{te(w=>({...w,kategori:r.target.value}))},className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})]}),e.jsx("button",{className:"w-full py-3 mt-3 cursor-pointer rounded-lg bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-semibold shadow-md hover:opacity-90 transition",type:"submit",children:"Tambah Transaksi"})]})]}):e.jsxs(e.Fragment,{children:[S?null:e.jsxs("div",{className:"text-center",children:[e.jsx(oe,{className:"text-3xl mx-auto mb-2 text-gray-500"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Scan / Upload Struk"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Pilih cara untuk memindai struk transaksi Anda"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("label",{onClick:()=>L("camera"),className:"flex flex-col items-center justify-center bg-indigo-600 text-white p-3 rounded-xl hover:bg-indigo-700 transition",children:[e.jsx(oe,{className:"text-2xl mb-1"}),e.jsx("span",{children:"Foto dengan Kamera"})]}),e.jsxs("label",{htmlFor:"uploadInput",className:"flex flex-col items-center justify-center bg-gray-100 text-gray-700 p-4 rounded-xl hover:bg-gray-200 transition cursor-pointer",children:[e.jsx(Ke,{className:"text-2xl mb-1"}),e.jsx("span",{children:"Upload Foto"}),e.jsx("input",{id:"uploadInput",type:"file",accept:"image/*",onChange:Be,className:"hidden"})]})]})]}),S==="camera"&&e.jsx(_t,{setResultOcr:z,setTipeMode:L,setPreviewImage:k,setProsesLoading:j})]})})})]})})}),e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-4 sm:p-6 container mx-auto overscroll-auto overflow-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Riwayat Transaksi"}),e.jsx("button",{className:"text-red-500 hover:underline text-sm cursor-pointer",onClick:()=>c(!x),children:x?"Selesai":"Edit Transaksi"})]}),e.jsx("div",{className:"overscroll-auto overflow-auto h-100",children:y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-gray-500",children:[e.jsx(X.div,{className:"w-10 h-10 border-4 border-yellow-500 border-t-transparent rounded-full",animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"}}),e.jsx("p",{className:"mt-3 text-sm",children:"Memuat transaksi..."})]}):P.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 py-6",children:[e.jsx(Me,{className:"size-24 text-yellow-500"}),e.jsx("p",{className:"text-center text-sm sm:text-base",children:"Belum ada transaksi. Yuk tambahkan transaksi Anda"})]}):e.jsx("ul",{className:"divide-y divide-gray-200",children:e.jsx(ot,{children:P.map(r=>{const w=J.find(F=>F.name===r.list_kategori.icon)||{icon:le,color:"text-gray-400"},B=w.icon;return e.jsxs(X.li,{className:"flex items-center justify-between py-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:"easeOut"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[x&&e.jsx("input",{name:"transaksi",type:"radio",className:"w-4 h-4 cursor-pointer",onChange:()=>Pe(r)}),e.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-gray-100 rounded-full",children:e.jsx(B,{className:`text-2xl ${w.color}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium font-sans capitalize",children:r.note}),e.jsx("p",{className:"text-sm font-sans",children:new Date(r.created_at).toLocaleDateString("id-ID",{day:"numeric",month:"short"})})]})]}),e.jsxs("span",{className:`font-semibold ${r.type==="pemasukan"?"text-green-600":"text-red-600"}`,children:[r.type==="pemasukan"?"+":"-",K(parseInt(r.amount))]})]},r.id)})})})})]}),R&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Tambah Kategori"}),e.jsx("button",{onClick:()=>Z(!1),children:e.jsx(xt,{className:"w-6 h-6 text-gray-500 hover:text-gray-700 cursor-pointer"})})]}),e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Nama Kategori"}),e.jsx("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"masukan nama kategori terbaru",value:ne,onChange:r=>me(r.target.value)}),e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Pilih Ikon"}),e.jsx("div",{className:"grid grid-cols-6 gap-3 mb-6",children:J.map(({name:r,icon:w,color:B},F)=>e.jsx("button",{onClick:()=>H(r),type:"button",className:`text-2xl p-2 rounded-lg transition cursor-pointer ${A===r?"bg-indigo-200 ring-2 ring-indigo-500":"bg-gray-100 hover:bg-indigo-100"}`,children:e.jsx(w,{className:`text-2xl ${B}`})},F))}),e.jsx("button",{onClick:I,className:"w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition cursor-pointer",children:"Simpan Kategori"})]})}),h&&g&&e.jsx(Rt,{transaksi:g,onClose:()=>p(!1),onDeleted:q,onSave:q,onEditmode:c})]})},zt=()=>e.jsx(e.Fragment,{children:e.jsx(Mt,{})});function Ut(){const t=ye(),[n,u]=a.useState(!1),l=async()=>{try{u(!0);const c=(await st(de,Pt)).user,g=await c.getIdToken();localStorage.setItem("user",JSON.stringify({uid:c.uid,email:c.email,displayName:c.displayName})),await Promise.all([nt(rt(It,"users",c.uid),{name:c.displayName,email:c.email,lastLogin:new Date}),$.post(`${E}/auth/login`,{email:c.email,name:c.displayName},{headers:{Authorization:`Bearer ${g}`}})]),Bt(c),t("/dasboard")}catch(x){console.error(x),u(!1)}};return e.jsxs(e.Fragment,{children:[n&&e.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex flex-col items-center justify-center animate-fadeIn",children:[e.jsxs("div",{className:"relative w-20 h-20",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-blue-300 rounded-full animate-ping"}),e.jsx("div",{className:"absolute inset-2 border-4 border-blue-500 rounded-full animate-spin border-t-transparent"})]}),e.jsx("p",{className:"mt-6 text-gray-700 text-lg font-semibold animate-pulse",children:"Sedang memproses login..."})]}),e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-2xl p-8 w-full max-w-md text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"bg-yellow-400 p-4 rounded-full shadow-md",children:e.jsx("span",{className:"text-3xl text-white",children:e.jsx(ze,{})})})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Selamat Datang"}),e.jsx("p",{className:"text-gray-600 mb-5",children:"Silakan masuk untuk mengakses aplikasi money tracker anda"}),e.jsx("button",{className:`flex items-center justify-center gap-2 w-full border border-gray-300 py-4 rounded-lg shadow-sm \r
                        hover:bg-gray-50 transition cursor-pointer disabled:opacity-60 disabled:cursor-not-allowed`,onClick:l,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Memproses..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"text-xl text-lime-600"}),e.jsx("span",{className:"font-medium",children:"Masuk dengan Google"})]})}),e.jsxs("div",{className:"mt-8 grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(He,{className:"w-8 h-8 mb-2 text-lime-500"}),e.jsxs("span",{children:["Laporan ",e.jsx("br",{})," Real-time"]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(We,{className:"w-8 h-8 mb-2 text-yellow-300"}),e.jsxs("span",{children:["Kelola Transaksi ",e.jsx("br",{})," Real-time"]})]})]})]})}),e.jsx("style",{children:`
                @keyframes fadeIn {
                    from { opacity: 0 }
                    to { opacity: 1 }
                }
                .animate-fadeIn {
                    animation: fadeIn .3s ease-in-out;
                }
            `})]})}ft.register(bt,jt,kt,yt,wt,vt,Nt,Ct);const Ht=()=>{const{user:t}=M(),[n,u]=a.useState([]),[l,x]=a.useState(!0),c=async()=>{const h=await t.getIdToken();try{const i=(await $.get(`${E}/transaksi-all-line`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}})).data.data;u(i)}catch{}finally{x(!1)}},g=a.useMemo(()=>{const h={};n.forEach(i=>{const f=new Date(i.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short"});h[f]||(h[f]={pemasukan:0,pengeluaran:0});const k=parseFloat(i.amount)||0;i.type==="pemasukan"?h[f].pemasukan+=k:i.type==="pengeluaran"&&(h[f].pengeluaran+=k)});const p=Object.keys(h).sort((i,m)=>new Date("1",i)-new Date("1",m));return{labels:p,datasets:[{label:"Pemasukan",data:p.map(i=>h[i].pemasukan),borderColor:"#22f7b0ff",backgroundColor:"rgba(13, 255, 174, 0.25)",tension:.5,fill:!0},{label:"Pengeluaran",data:p.map(i=>h[i].pengeluaran),borderColor:"#ef4444",backgroundColor:"#ef4444",tension:.5,fill:!0}]}},[n]),d={responsive:!0,plugins:{legend:{position:"top",labels:{usePointStyle:!0,boxWidth:25}},tooltip:{callbacks:{label:h=>{const p=h.dataset.label||"",i=h.parsed.y||0;return`${p}: Rp ${i.toLocaleString("id-ID")}`}}},datalabels:{color:"#333",anchor:"end",align:"top",font:{weight:"bold",size:13},formatter:h=>h===0?"":"Rp "+h.toLocaleString("id-ID")}},scales:{y:{ticks:{callback:h=>"Rp."+h.toLocaleString("id-ID")}}}};return a.useEffect(()=>{c()},[t]),e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["Grafik Pemasukan vs Pengeluaran"," ",new Date().toLocaleString("id-ID",{year:"numeric"})]}),l?"Loading..":e.jsx(pt,{data:g,options:d})]})},Wt=({data:t})=>{const[n,u]=a.useState(!1),[l,x]=a.useState(""),{user:c}=M(),g=a.useMemo(()=>{const o={},y=new Set;t.forEach(I=>{var J,ee;const A=((J=I.list_kategori)==null?void 0:J.name)||"Tanpa Kategori",H=((ee=I.list_kategori)==null?void 0:ee.icon)||"lain-lain",R=I.type,Z=parseFloat(I.amount)||0,b=new Date(I.created_at);if(isNaN(b))return;const z=`${b.getFullYear()} - ${String(b.getMonth()+1).padStart(2,"0")}`;o[R]||(o[R]={}),o[R][A]||(o[R][A]={icon:H,perBulan:{}}),o[R][A].perBulan[z]=(o[R][A].perBulan[z]||0)+Z,y.add(z)});const N=Array.from(y).sort(),P=N.at(-1),C=N.at(-2),D=(I,A)=>Object.values(o[I]||{}).reduce((H,R)=>H+(R.perBulan[A]||0),0),W=D("pengeluaran",P),se=D("pengeluaran",C),G=D("pemasukan",P),q=D("pemasukan",C),O=(I,A)=>A===0&&I>0?100:A===0&&I===0?0:((I-A)/A*100).toFixed(1),Q=O(W,se),ne=O(G,q);return{kategoriList:Object.entries(o.pengeluaran||{}).map(([I,A])=>{var H;return{kategori:I,nominal:((H=A.perBulan)==null?void 0:H[P])||0,icon:A.icon}}).map(I=>({...I,persen:W?(I.nominal/W*100).toFixed(1):0})),lastBulan:P,prevBulan:C,totalPengeluaran:W,totalPersenPengeluaran:Q,totalPemasukan:G,totalPersenPemasukan:ne}},[t]),{kategoriList:d,lastBulan:h,totalPengeluaran:p,totalPersenPengeluaran:i,totalPemasukan:m,totalPersenPemasukan:f}=g,k=[{name:"transportasi",icon:he,color:"#3B82F6"},{name:"makan",icon:fe,color:"#FACC15"},{name:"bill",icon:be,color:"#22C55E"},{name:"tabun1",icon:je,color:"#EC4899"},{name:"donasi",icon:ke,color:"#8B5CF6"},{name:"lain-lain",icon:le,color:"#4084faff"}],T=d.map(o=>(k.find(N=>N.name===o.icon)||k.at(-1)).color),j={labels:d.map(o=>o.kategori),datasets:[{data:d.map(o=>o.nominal),backgroundColor:T,borderWidth:2,borderColor:"#fff"}]},S={plugins:{legend:{display:!0,position:"bottom",labels:{usePointStyle:!0}},tooltip:{callbacks:{label:o=>{var C;const y=o.label||"",N=o.parsed||0,P=((C=d.find(D=>D.kategori===y))==null?void 0:C.persen)||0;return`${y}: ${K(N)} (${P}%)`}}}},responsive:!0,maintainAspectRatio:!1,cutout:"73%"},L=o=>{if(o){const[y,N]=o.split(" - ").map(Number);return new Date(y,N-1).toLocaleString("id-ID",{month:"long",year:"numeric"})}return"Tidak Ada Data"},s=async()=>{const o=await c.getIdToken();try{u(!0);const y=g.kategoriList.filter(C=>C.persen>0),N=g.kategoriList.filter(C=>C.persen<0),P=await $.post(`${E}/analisis-laporan`,{prev:L(g.prevBulan),last:L(g.lastBulan),naik:y,turun:N},{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});P.data.kode===200?x(P.data.message):v.fire({icon:"error",title:"Gagal Analisis",text:P.data.message||"Terjadi kesalahan tak dikenal."})}catch{v.fire({icon:"error",title:"Analisis Gagal"})}finally{u(!1)}};return e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg text-center font-semibold mb-5",children:["Pengeluaran PerKategori ",L(h)]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-around mb-5 text-center mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Pemasukan Bulan Ini"}),e.jsx("p",{className:"text-2xl font-bold text-green-500",children:K(m)}),e.jsxs("p",{className:`text-sm ${f>=0?"text-green-500":"text-red-500"}`,children:[f>=0?"+":"",f,"% dibanding bulan lalu"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Pengeluaran Bulan Ini"}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:K(p)}),e.jsxs("p",{className:`text-sm ${i>=0?"text-red-500":"text-green-500"}`,children:[i>=0?"+":"",i,"% dibanding bulan lalu"]})]})]}),e.jsxs("div",{className:"mt-4 mb-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-center gap-6",children:[e.jsxs("div",{className:"relative flex justify-center items-center w-[250px] h-[250px] sm:w-[300px] sm:h-[300px]",children:[e.jsx(ht,{data:j,options:{...S,responsive:!0,maintainAspectRatio:!1}}),p?e.jsx("button",{onClick:o=>{o.preventDefault(),s()},className:"absolute text-white font-semibold rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform duration-300 cursor-pointer",style:{width:"35%",height:"35%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:10,background:"linear-gradient(135deg, #6366F1, #EC4899, #F59E0B)",backgroundSize:"200% 200%",animation:"gradientMove 4s ease infinite"},children:n?"Loading...":"Analisis"}):null,e.jsx("style",{children:`
                    @keyframes gradientMove {
                        0% { background-position: 0% 50%; }
                        50% { background-position: 100% 50%; }
                        100% { background-position: 0% 50%; }
                    }
                `})]}),e.jsx("div",{className:"w-full max-w-sm space-y-3",children:d.map((o,y)=>{const N=k.find(D=>D.name.toLowerCase()===o.kategori.toLowerCase())||k.at(-1),P=N.icon,C=N.color;return e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 px-4 py-3 rounded-xl shadow-sm hover:shadow-md transition",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-6 h-6 text-white p-1 rounded",style:{backgroundColor:C}}),e.jsx("span",{className:"font-medium text-sm sm:text-base",children:o.kategori})]}),e.jsxs("div",{className:"text-right text-sm sm:text-base",children:[e.jsxs("p",{className:"font-semibold",children:[o.persen,"%"]}),e.jsx("p",{className:"text-gray-500",children:K(o.nominal)})]})]},y)})})]}),l?e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-5 text-sm leading-relaxed overflow-auto",dangerouslySetInnerHTML:{__html:St.sanitize(l)}}):null]})]})},Gt=()=>{const{user:t}=M(),{kategori:n,setKategori:u,kategoriAll:l}=a.useContext(ae),[x,c]=a.useState("30 Hari Terakhir"),[g,d]=a.useState("All"),[h,p]=a.useState([]),[i,m]=a.useState(!1),[f,k]=a.useState(0),[T,j]=a.useState(0),S=async()=>{const s=await t.getIdToken();m(!0);try{const o={periode:x,jenis:g,kategori:n},y=await $.post(`${E}/filter-laporan`,o,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});p(y.data.data);const N=y.data.data.filter(C=>C.type==="pemasukan").reduce((C,D)=>C+parseInt(D.amount),0),P=y.data.data.filter(C=>C.type==="pengeluaran").reduce((C,D)=>C+parseInt(D.amount),0);k(N),j(P)}catch{}finally{m(!1)}},L=[{name:"Tanggal",selector:s=>new Date(s.created_at).toLocaleDateString("id-ID",{month:"short",day:"numeric",year:"numeric"}),sortable:!0,width:"120px"},{name:"Keterangan",selector:s=>s.note,sortable:!0,wrap:!0},{name:"Kategori",selector:s=>s.list_kategori.name,sortable:!0},{name:"Status",sortable:!0,selector:s=>s.type,width:"150px",cell:s=>e.jsx("span",{className:`rounded-full text-white ${s.type==="pemasukan"?"bg-green-500":"bg-red-500"} py-1 px-3`,children:s.type.toUpperCase()})},{name:"Nominal",selector:s=>s.amount,sortable:!0,cell:s=>e.jsxs("span",{children:["Rp ",parseInt(s.amount).toLocaleString("id-ID")]})}];return a.useEffect(()=>{const s=()=>{localStorage.getItem("dataTransaksiUpdated")==="true"&&t&&(S(),localStorage.removeItem("dataTransaksiUpdated"))};return window.addEventListener("focus",s),s(),()=>{window.removeEventListener("focus",s)}},[t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto mt-2",children:[e.jsx("div",{className:"md:p-2 p-0",children:e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-3 md:p-5",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Filter Laporan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Periode"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",onChange:s=>c(s.target.value),children:[e.jsx("option",{value:"All",children:"All Periode"}),e.jsx("option",{value:"30 Hari Terakhir",children:"30 Hari Terakhir"}),e.jsx("option",{value:"7 Hari Terakhir",children:"7 Hari Terakhir"}),e.jsx("option",{value:"Bulan Ini",children:"Bulan Lalu"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Jenis Transaksi"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",onChange:s=>d(s.target.value),children:[e.jsx("option",{value:"All",children:"All"}),e.jsx("option",{value:"pemasukan",children:"Pemasukan"}),e.jsx("option",{value:"pengeluaran",children:"Pengeluaran"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Kategori"}),e.jsxs("select",{className:"w-full border rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500",name:"kategori",value:n,onChange:s=>u(s.target.value),children:[e.jsx("option",{value:"All",children:"All"},"All"),l.map(s=>e.jsx("option",{value:s.kategori_id,children:s.name.toUpperCase()},s.kategori_id))]})]}),e.jsx("button",{className:"mt-1 w-50 px-5 py-2.5 bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-semibold rounded-lg shadow cursor-pointer",onClick:s=>{s.preventDefault(),S()},children:i?"Memproses...":"Generate Laporan"})]})]})}),e.jsx("div",{className:"p-1 md:p-2 mt-1",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4 p-3",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow text-center",children:[e.jsx("p",{className:"text-sm",children:"Total Pemasukan"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:i?e.jsx(ie,{className:"animate-spin text-gray-400 inline-block"}):K(f)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow text-center",children:[e.jsx("p",{className:"text-sm",children:"Total Pengeluaran"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:i?e.jsx(ie,{className:"animate-spin text-gray-400 inline-block"}):K(T)})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Detai Transaksi"}),e.jsx(gt,{columns:L,data:h,progressPending:i,progressComponent:e.jsxs("div",{className:"flex items-center justify-center py-6 text-gray-500",children:[e.jsx(ie,{className:"animate-spin text-blue-500 mr-2"}),"Sabar ya lagi memuat data..."]}),pagination:!0,highlightOnHover:!0,striped:!0,paginationPerPage:10,noDataComponent:"Tidak ada data laporan ditemukan"})]}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow ",children:e.jsx(Ht,{})})]}),e.jsx("div",{className:"bg-white p-5 rounded-xl shadow ",children:e.jsx(Wt,{data:h})})]})})};function qt(){const{user:t}=M(),n=ye(),u=we(),l=c=>u.pathname===c,x=async()=>{await it(de),n("/",{replace:!0})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 p-1 rounded-b-lg mb-1 w-auto sm:max-7xl",children:e.jsxs("div",{className:"p-4 container lg:mx-auto sm:w-full ",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-white text-xl font-bold flex items-center gap-2",children:[e.jsx(Ge,{className:"text-green-400 text-2xl"}),e.jsx("span",{children:"Money Tracker"})]}),e.jsx("button",{onClick:x,className:`\r
                                    text-white \r
                                    text-4xl         \r
                                    sm:text-2xl       \r
                                    xs:text-xl        \r
                                    mr-3 sm:mr-6       \r
                                    relative  sm:top-0    \r
                                    cursor-pointer \r
                                    hover:text-gray-200 \r
                                    transition-all duration-200\r
                                `,children:e.jsx(qe,{})})]}),e.jsx("p",{className:"text-white text-sm xs:text-base",children:"Kendalikan uang, pahami keuangan Anda"})]})}),e.jsx("div",{className:"bg-white shadow-lg rounded-lg mx-auto mb-3 container relative",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-start p-3 gap-2 sm:gap-4 relative",children:[e.jsxs("button",{onClick:()=>n("/dasboard"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-semibold transition-all duration-300 cursor-pointer ${l("/dasboard")?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Oe,{className:`size-6 ${l("/dasboard")?"text-white":"text-blue-600"}`}),e.jsx("span",{className:"text-sm sm:text-base",children:"Dashboard"})]}),e.jsxs("button",{onClick:()=>n("/laporan"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-semibold transition-all duration-300 cursor-pointer ${l("/laporan")?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(Je,{className:`size-6 ${l("/laporan")?"text-white":"text-blue-600"}`}),e.jsx("span",{className:"text-sm sm:text-base",children:"Laporan"})]}),e.jsxs("div",{className:"absolute right-4 top-2 sm:top-3 flex items-center gap-2",children:[e.jsx("img",{src:`${t==null?void 0:t.photoURL}`,className:"rounded-full size-8 sm:size-10"}),e.jsx("p",{className:"hidden sm:block text-sm sm:text-base",children:t==null?void 0:t.displayName})]})]})})]})}const Ot=()=>e.jsxs(e.Fragment,{children:[e.jsx(qt,{}),e.jsx("main",{className:"app-csh",children:e.jsx(ct,{})})]}),Jt="modulepreload",Vt=function(t){return"/"+t},pe={},Yt=function(n,u,l){let x=Promise.resolve();if(u&&u.length>0){let g=function(p){return Promise.all(p.map(i=>Promise.resolve(i).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));x=g(u.map(p=>{if(p=Vt(p),p in pe)return;pe[p]=!0;const i=p.endsWith(".css"),m=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${m}`))return;const f=document.createElement("link");if(f.rel=i?"stylesheet":Jt,i||(f.as="script"),f.crossOrigin="",f.href=p,h&&f.setAttribute("nonce",h),document.head.appendChild(f),i)return new Promise((k,T)=>{f.addEventListener("load",k),f.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(g){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=g,window.dispatchEvent(d),!d.defaultPrevented)throw g}return x.then(g=>{for(const d of g||[])d.status==="rejected"&&c(d.reason);return n().catch(c)})};function Xt(t={}){const{immediate:n=!1,onNeedRefresh:u,onOfflineReady:l,onRegistered:x,onRegisteredSW:c,onRegisterError:g}=t;let d,h;const p=async(m=!0)=>{await h};async function i(){if("serviceWorker"in navigator){if(d=await Yt(async()=>{const{Workbox:m}=await import("./workbox-window-CwtvwXb3.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{g==null||g(m)}),!d)return;d.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),d.addEventListener("installed",m=>{m.isUpdate||l==null||l()}),d.register({immediate:n}).then(m=>{c?c("/sw.js",m):x==null||x(m)}).catch(m=>{g==null||g(m)})}}return h=i(),p}const Qt=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-blue-800 to-blue-600 text-white px-4 overflow-hidden",children:[e.jsx(X.h1,{initial:{scale:.8,opacity:0},animate:{scale:[1,1.1,1],y:[0,-10,0],opacity:1,textShadow:["0 0 20px rgba(255,255,255,0.4)","0 0 60px rgba(255,255,255,0.7)","0 0 20px rgba(255,255,255,0.4)"]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"text-[9rem] md:text-[12rem] font-extrabold drop-shadow-lg text-white select-none",children:"404"}),e.jsxs(X.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.8,ease:"easeOut"},className:"mt-6 bg-white/10 backdrop-blur-lg px-8 py-6 rounded-2xl shadow-lg text-center max-w-md w-full",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2 text-white",children:"Halaman Tidak Ditemukan"}),e.jsx("p",{className:"text-gray-200 mb-6",children:"Halaman yang Anda cari tidak ada atau telah dipindahkan ke lokasi lain."}),e.jsx(dt,{to:"/",className:"inline-block bg-white text-blue-700 font-semibold px-6 py-2 rounded-lg shadow hover:bg-gray-100 transition duration-300",children:"Kembali ke Beranda"})]})]}),Zt=()=>{const t=we();return a.useEffect(()=>{const n={"/":"Login ","/dasboard":"Dashboard","/laporan":"Laporan ","*":"404 Not Found"};document.title=n[t.pathname]||"404 Not Found | CashFlow"},[t]),null},ea=()=>(a.useEffect(()=>{Lt().then(t=>v.fire({icon:"info",text:`${t.notification.title}: ${t.notification.body}`,showConfirmButton:!1,timer:1500})).catch(t=>console.log(t))},[]),e.jsx(At,{children:e.jsx(Ft,{children:e.jsx(Et,{children:e.jsxs(mt,{children:[e.jsx(Zt,{}),e.jsxs(ut,{children:[e.jsx(Y,{path:"/",element:e.jsx(Ut,{})}),e.jsxs(Y,{element:e.jsx(Dt,{children:e.jsx(Ot,{})}),children:[e.jsx(Y,{path:"/dasboard",element:e.jsx(zt,{})}),e.jsx(Y,{path:"/laporan",element:e.jsx(Gt,{})})]}),e.jsx(Y,{path:"*",element:e.jsx(Qt,{})})]})]})})})})),ta=Fe.createRoot(document.getElementById("app"));ta.render(e.jsx(ea,{}));const aa=Xt({onNeedRefresh(){confirm("Versi baru tersedia. Muat ulang sekarang?")&&aa(!0)},onOfflineReady(){console.log("Aplikasi siap digunakan secara offline!")}});
